<tool id="show-snps" name="Show-SNPs" version="0.1.0">
    <requirements>
        <requirement type="package" version="4.0.0beta2">mummer4</requirement>
    </requirements>
    <command detect_errors="exit_code">
        <![CDATA[
        show-snps
            $ambig_mapping
            $header
            $indels
            $seq_length
            $sort
            -x $flanking
            '$delta' > '$output'
        ]]>
    </command>
    <inputs>
        <param name="delta" type="data" format="txt" label="Delta File" />
        <param name="ambig_mapping" type="boolean" argument="-C" truevalue="-C" falsevalue="" label="Ambiguous Mapping" help="Do not report SNPs from alignments with an ambiguous mapping, i.e. only report SNPs where the [R] and [Q] columns equal 0 and do not output these columns" />
        <param name="header" type="boolean" argument="-H" truevalue="-H" falsevalue="" label="Do not print the output header" />
        <param name="indels" type="boolean" argument="-I" truevalue="-I" falsevalue="" label="Do not report indels" />
        <param name="seq_length" type="boolean" argument="-l" truevalue="-l" falsevalue="" label="Include sequence length information in the output" />
        <param name="sort" type="select" label="Sort output by reference/query IDs and SNP positions" >
            <option value="-q">Query</option>
            <option value="-r">Refercence</option>
        </param>
        <param name="flanking" type="integer" argument="-x" value="0" label="Flanking characters" help="Include x characters of surrounding SNP context in the output" />
    </inputs>
    <outputs>
        <data name="output" format="txt" from_work_dir="show-snps.txt" label="show_snps" />
    </outputs>
    <tests>
        <test>
            <param name="delta" ftype="txt" value="nucmer.txt" />
            <output name="output" ftype="txt" compare="diff" value="show-snps.txt" />
        </test>
    </tests>
    <help><![CDATA[
This program reports polymorphism contained in a delta encoded alignment file output by either nucmer or promer. It catalogs all of the single nucleotide polymorphisms (SNPs) and insertions/deletions within the delta file alignments. Polymorphisms are reported one per line, in a delimited fashion similar to show-coords. Pairing this program with the appropriate MUMmer tools can create an easy to use SNP pipeline for the rapid identification of putative SNPs between any two sequence sets.

Standard output has column headers with the following meanings:
    * **[P1]** SNP position in the reference
    * **[SUB]** Character in the reference
    * **[P2]** SNP position in the query
    * **[SUB]** Character in the query
    * **[BUFF]** Distance from this SNP to the nearest mismatch (end of alignment, indel, SNP, etc) in the same alignment.
    * **[DIST]** Distance from this SNP to the nearest sequence end
    * **[R]** Number of repeat alignments which cover this reference position, >0 means repetitive sequence
    * **[Q]** Number of repeat alignments which cover this query position, >0 mean repetitive sequence
    * **[LEN R]** Length of the reference sequence
    * **[LEN Q]** Length of the query sequence
    * **[CTX R]** Surrounding context sequence in the reference
    * **[CTX Q]** Surrounding context sequence in the query
    * **[FRM]** Reading frame for the reference sequence and the reading frame for the query sequence respectively. Simply 'forward' 1, or 'reverse' -1 for nucmer data.
    * **[TAGS]** The reference FastA ID and the query FastA ID

It is often helpful to run this with the -C option to assure reported SNPs are only reported from uniquely aligned regions.
    ]]></help>
    <citations>
        <citation type="bibtex">
            @misc{githubmummer,
            author = {Art Delcher, Stefan Kurtz, Adam Phillippy, Steven Salzberg},
            year = {2012},
            title = {mummer4},
            publisher = {GitHub},
            journal = {GitHub repository},
            url = {https://github.com/mummer4/mummer},
        }</citation>
    </citations>
</tool>